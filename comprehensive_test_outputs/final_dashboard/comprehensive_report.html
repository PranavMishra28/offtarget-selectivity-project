
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Off-Target Selectivity Analysis Report</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; }
                .header { background-color: #f0f0f0; padding: 20px; border-radius: 5px; }
                .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
                .metric { display: inline-block; margin: 10px; padding: 10px; background-color: #e8f4f8; border-radius: 5px; }
                .decision { font-size: 24px; font-weight: bold; padding: 20px; border-radius: 5px; }
                .decision.synthesize { background-color: #d4edda; color: #155724; }
                .decision.watch { background-color: #fff3cd; color: #856404; }
                .decision.reject { background-color: #f8d7da; color: #721c24; }
                .visualization { margin: 20px 0; text-align: center; }
                iframe { width: 100%; height: 600px; border: none; }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>üß™ Off-Target Selectivity Analysis Report</h1>
                <p>Comprehensive analysis of compound selectivity, safety, and synthesis feasibility</p>
                <p><strong>Generated:</strong> 2025-07-18 01:39:22</p>
            </div>
            
            <div class="section">
                <h2>üéØ Executive Summary</h2>
                <div class="decision watch">
                    Synthesis Decision: Watch
                </div>
                <div class="metric">
                    <strong>Selectivity Score:</strong> 1.119
                </div>
                <div class="metric">
                    <strong>Safety Score:</strong> 0.000
                </div>
            </div>
            
            <div class="section">
                <h2>üìä Pipeline Overview</h2>
                <div class="visualization">
                    <iframe src="pipeline_overview.html"></iframe>
                </div>
            </div>
            
            <div class="section">
                <h2>‚ö†Ô∏è Risk Assessment</h2>
                <div class="visualization">
                    <iframe src="risk_assessment.html"></iframe>
                </div>
            </div>
            
            <div class="section">
                <h2>üéØ Selectivity Analysis</h2>
                <div class="visualization">
                    <iframe src="selectivity_analysis.html"></iframe>
                </div>
            </div>
            
            <div class="section">
                <h2>üß¨ Expression Analysis</h2>
                <div class="visualization">
                    <iframe src="expression_analysis.html"></iframe>
                </div>
            </div>
            
            <div class="section">
                <h2>‚öóÔ∏è Synthesis Feasibility</h2>
                <div class="visualization">
                    <iframe src="synthesis_feasibility.html"></iframe>
                </div>
            </div>
            
            <div class="section">
                <h2>üìà Summary Dashboard</h2>
                <div class="visualization">
                    <img src="summary_dashboard.png" alt="Summary Dashboard" style="max-width: 100%;">
                </div>
            </div>
            
            <div class="section">
                <h2>üìã Detailed Results</h2>
                <pre>{
  "nebula": {
    "input_smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
    "generation_config": {
      "library": "moses",
      "num_variants": 5,
      "novelty_threshold": 0.7,
      "validity_check": true,
      "pains_filter": true
    },
    "generation_stats": {
      "total_generated": 5,
      "valid_molecules": 5,
      "conformers_generated": 15,
      "validation_rate": 1.0
    },
    "validation_results": [
      {
        "valid": true,
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "molecular_weight": 180.15899999999996,
        "logp": 1.3101,
        "hbd": 1,
        "hba": 3,
        "rotatable_bonds": 2,
        "rings": 1,
        "aromatic_rings": 1,
        "pains_filter": false,
        "lipinski_violations": 0,
        "reason": null
      },
      {
        "valid": true,
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "molecular_weight": 180.15899999999996,
        "logp": 1.3101,
        "hbd": 1,
        "hba": 3,
        "rotatable_bonds": 2,
        "rings": 1,
        "aromatic_rings": 1,
        "pains_filter": false,
        "lipinski_violations": 0,
        "reason": null
      },
      {
        "valid": true,
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "molecular_weight": 180.15899999999996,
        "logp": 1.3101,
        "hbd": 1,
        "hba": 3,
        "rotatable_bonds": 2,
        "rings": 1,
        "aromatic_rings": 1,
        "pains_filter": false,
        "lipinski_violations": 0,
        "reason": null
      },
      {
        "valid": true,
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "molecular_weight": 180.15899999999996,
        "logp": 1.3101,
        "hbd": 1,
        "hba": 3,
        "rotatable_bonds": 2,
        "rings": 1,
        "aromatic_rings": 1,
        "pains_filter": false,
        "lipinski_violations": 0,
        "reason": null
      },
      {
        "valid": true,
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "molecular_weight": 180.15899999999996,
        "logp": 1.3101,
        "hbd": 1,
        "hba": 3,
        "rotatable_bonds": 2,
        "rings": 1,
        "aromatic_rings": 1,
        "pains_filter": false,
        "lipinski_violations": 0,
        "reason": null
      }
    ]
  },
  "sparrow": {
    "status": "loaded",
    "ranked_candidates": [
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      },
      {
        "smiles": "CC(=O)Oc1ccccc1C(=O)O",
        "mol_wt": 180.159,
        "logp": 1.3101,
        "prioritization_score": 0.0024027758448547
      }
    ]
  },
  "empirical_binding": {
    "status": "loaded",
    "predictions": {
      "E7ESS9": 1.0,
      "A8K802": 1.0,
      "B4DI32": 0.8571428656578064,
      "Q5H927": 0.8571428656578064,
      "B2RXH2": 0.8571428656578064,
      "P11712": 0.8571428656578064,
      "P10635": 0.8571428656578064,
      "P05177": 0.8571428656578064,
      "P33259": 0.8571428656578064,
      "P05184": 0.8571428656578064,
      "P23197": 0.8571428656578064,
      "A0PJ95": 0.8571428656578064,
      "B3KMM8": 0.8571428656578064,
      "E7EMT8": 0.8571428656578064,
      "B2R7G2": 0.8571428656578064,
      "A8K2G5": 0.8571428656578064,
      "P27695": 0.8571428656578064,
      "O94975": 0.8571428656578064,
      "B4E2A5": 0.8571428656578064,
      "A8CZ64": 0.699999988079071
    }
  },
  "structure_modeling": {
    "status": "loaded",
    "binding_risk": {
      "uniprot_id": "A8CZ64",
      "rmsd": 4.21,
      "binding_score": 0.923,
      "pose_stable": true,
      "notes": "Simulated pose via mock docking. Replace with AlphaFold + PLIP for real use."
    }
  },
  "impact_risk": {
    "status": "loaded",
    "summary": {
      "on_target_id": "P33259",
      "on_target_score": 0.7586,
      "avg_off_target_score": 0.6782,
      "selectivity_score": 1.1185,
      "risky_offtargets": [
        {
          "uniprot_id": "O94975",
          "combined_score": 0.9036
        },
        {
          "uniprot_id": "P23197",
          "combined_score": 0.8831
        },
        {
          "uniprot_id": "P10635",
          "combined_score": 0.8221
        },
        {
          "uniprot_id": "A8CZ64",
          "combined_score": 0.8115
        },
        {
          "uniprot_id": "B4DI32",
          "combined_score": 0.7821
        },
        {
          "uniprot_id": "A8K802",
          "combined_score": 0.7745
        },
        {
          "uniprot_id": "B2R7G2",
          "combined_score": 0.7721
        },
        {
          "uniprot_id": "P27695",
          "combined_score": 0.7556
        },
        {
          "uniprot_id": "B2RXH2",
          "combined_score": 0.7286
        },
        {
          "uniprot_id": "P05184",
          "combined_score": 0.7121
        }
      ],
      "decision_flag": "Watch"
    },
    "detailed": {
      "compound_info": {
        "smiles": "CC(=O)OC1=CC=CC=C1C(=O)O",
        "on_target_id": "P33259",
        "on_target_score": 0.76
      },
      "selectivity_analysis": {
        "metrics": {
          "selectivity_score": 1.0,
          "selectivity_index": Infinity,
          "off_target_count": 0,
          "risk_distribution": {},
          "selectivity_classification": "Unknown"
        },
        "off_target_scores": {},
        "combined_scores": {
          "P33259": 0.76
        }
      },
      "safety_analysis": {
        "ion_channel_risks": {
          "herg_risk": 0.2933333333333332,
          "nav_risk": 0.29119999999999996,
          "ca_risk": 0.05,
          "overall_ion_channel_risk": 0.2933333333333332,
          "risk_level": "Low",
          "descriptors": {
            "molecular_weight": 180.15899999999996,
            "logp": 1.3101,
            "tpsa": 63.60000000000001,
            "hbd": 1,
            "hba": 3,
            "aromatic_rings": 1,
            "rotatable_bonds": 2
          }
        },
        "safety_profile": {
          "safety_properties": {
            "molecular_weight": 180.15899999999996,
            "logp": 1.3101,
            "tpsa": 63.60000000000001,
            "hbd": 1,
            "hba": 3,
            "rotatable_bonds": 2,
            "rings": 1,
            "aromatic_rings": 1,
            "sp3_fraction": 0.1111111111111111,
            "lipinski_violations": 0,
            "veber_violations": 0
          },
          "safety_risks": {
            "ion_channel": {
              "herg_risk": 0.2933333333333332,
              "nav_risk": 0.29119999999999996,
              "ca_risk": 0.05,
              "overall_ion_channel_risk": 0.2933333333333332,
              "risk_level": "Low",
              "descriptors": {
                "molecular_weight": 180.15899999999996,
                "logp": 1.3101,
                "tpsa": 63.60000000000001,
                "hbd": 1,
                "hba": 3,
                "aromatic_rings": 1,
                "rotatable_bonds": 2
              }
            },
            "metabolic": {
              "risk_score": 0.2933,
              "risk_level": "Low"
            },
            "genotoxicity": {
              "risk_score": 0.2,
              "risk_level": "Low"
            },
            "hepatotoxicity": {
              "risk_score": 0.1,
              "risk_level": "Low"
            },
            "cardiotoxicity": {
              "risk_score": 0.2933,
              "risk_level": "Low",
              "ion_channel_contribution": 0.2933,
              "structural_contribution": 0.0
            }
          },
          "overall_safety_score": 0.7067,
          "safety_classification": "Good"
        }
      },
      "decision": {
        "decision": "Synthesize",
        "decision_score": 0.8827,
        "recommendations": [
          "Proceed with synthesis and testing",
          "Monitor for any unexpected off-target effects"
        ],
        "key_factors": {
          "selectivity_score": 1.0,
          "selectivity_index": Infinity,
          "safety_score": 0.7067,
          "ion_channel_risk": 0.2933333333333332
        }
      },
      "metadata": {
        "analysis_timestamp": "2025-07-18T01:35:04.554307",
        "analysis_method": "enhanced_impact"
      }
    }
  },
  "expression_filter": {
    "status": "loaded",
    "weighted_risks": {
      "O94975": {
        "original_score": 0.9036,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.9036
      },
      "P23197": {
        "original_score": 0.8831,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.8831
      },
      "P10635": {
        "original_score": 0.8221,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.8221
      },
      "A8CZ64": {
        "original_score": 0.8115,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.8115
      },
      "B4DI32": {
        "original_score": 0.7821,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7821
      },
      "A8K802": {
        "original_score": 0.7745,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7745
      },
      "B2R7G2": {
        "original_score": 0.7721,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7721
      },
      "P27695": {
        "original_score": 0.7556,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7556
      },
      "B2RXH2": {
        "original_score": 0.7286,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7286
      },
      "P05184": {
        "original_score": 0.7121,
        "avg_expression_tpm": 0.0,
        "avg_expression_percentile": 12.15,
        "tissue_weighted_score": 0.7121
      }
    }
  },
  "conflict_resolution": {
    "status": "loaded",
    "conflicts": {
      "B3KMM8": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "B2R7G2": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "P10635": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "P33259": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "A0PJ95": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "B4DI32": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "B4E2A5": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "A8K2G5": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "O94975": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "B2RXH2": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "P11712": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "A8CZ64": {
        "empirical_score": 0.699999988079071,
        "structural_score": 0.923,
        "delta": 0.223,
        "relation": "agreeing"
      },
      "P05177": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "E7EMT8": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "E7ESS9": {
        "empirical_score": 1.0,
        "structural_score": 0.0,
        "delta": 1.0,
        "relation": "conflict"
      },
      "P05184": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "A8K802": {
        "empirical_score": 1.0,
        "structural_score": 0.0,
        "delta": 1.0,
        "relation": "conflict"
      },
      "P27695": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "P23197": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      },
      "Q5H927": {
        "empirical_score": 0.8571428656578064,
        "structural_score": 0.0,
        "delta": 0.8571,
        "relation": "conflict"
      }
    }
  },
  "metadata": {
    "aggregation_timestamp": "2025-07-18T01:39:21.473484",
    "pipeline_version": "2.0",
    "data_sources": [
      "nebula",
      "sparrow",
      "empirical_binding",
      "structure_modeling",
      "impact_risk",
      "expression_filter",
      "conflict_resolution"
    ]
  }
}</pre>
            </div>
        </body>
        </html>
        